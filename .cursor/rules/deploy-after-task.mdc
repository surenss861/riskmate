---
description: At the end of every task, deploy to GitHub, Vercel, and Railway
alwaysApply: true
---

# Deploy at End of Every Task

**You MUST run deploy at the end of EVERY task.** No exceptions.

## Checklist (before you say "done")

- [ ] I ran `./scripts/deploy.sh "Short description of changes"` from the repo root.
- [ ] If it failed (e.g. "Could not resolve host", auth error): I told the user to run the same command locally.

## What to run

From repo root (e.g. `"coding projects/riskmate"`):

```bash
./scripts/deploy.sh "Brief description of what was done"
```

This script does (in order):

1. `git add -A` and `git commit -m "..."` (if there are changes)
2. `git push origin main` → GitHub (and triggers Vercel/Railway if repo is connected)
3. `npx vercel --prod` → Vercel production
4. `(cd apps/backend && railway up --detach)` (or `npx railway up --detach`) → Railway backend

## If push or deploy fails in this environment

- **Push fails** (e.g. "Could not resolve host: github.com", "Permission denied"): Tell the user exactly:  
  **"Deploy couldn’t run from here (network/auth). Run locally: `./scripts/deploy.sh 'Your message'`"**  
  and mention that Vercel/Railway will deploy automatically after a successful push if the repo is connected.
- **Vercel/Railway CLI fails**: Tell the user to push and then trigger deploy from Vercel/Railway dashboards or run the CLI on their machine.
- This environment cannot reach GitHub; deploy only happens when the user runs `git push origin main` on their machine. Tell them one line: **"Push to deploy: `git push origin main`"**
