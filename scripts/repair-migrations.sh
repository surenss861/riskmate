#!/usr/bin/env bash
# Mark all migrations up to 20260215000003 as applied so only 20260215100000_sync_delete_hazard_atomic runs on next push.
# Run from repo root. You already repaired 20241201000000 and 20241202000000.

set -e
for version in \
  20241225000000 \
  20241225000001 \
  20241225000002 \
  20250105000000 \
  20250105000001 \
  20250106000000 \
  20250115000000 \
  20250116000000 \
  20250116000001 \
  20250116000002 \
  20250116000003 \
  20250117000000 \
  20250117000001 \
  20250117000002 \
  20250118000000 \
  20250118000001 \
  20250119000000 \
  20250120000000 \
  20250121000000 \
  20250122000000 \
  20250122000002 \
  20250122000003 \
  20250122000004 \
  20250123000000 \
  20250123000001 \
  20250123000002 \
  20250124000000 \
  20250124000001 \
  20250124000002 \
  20250125000000 \
  20250125000002 \
  20250126000000 \
  20250126000001 \
  20250126000002 \
  20250127000000 \
  20250127000001 \
  20250127000002 \
  20250127000003 \
  20250127000004 \
  20250201000000 \
  20250215000000 \
  20251201000000 \
  20251202000000 \
  20251203000000 \
  20251203000001 \
  20251203000002 \
  20251203000003 \
  20251203000004 \
  20251203000005 \
  20260201000000 \
  20260211000000 \
  20260215000000 \
  20260215000001 \
  20260215000002 \
  20260215000003; do
  echo "Repairing $version..."
  supabase migration repair "$version" --status applied
done
echo "Done. Run: supabase db push --include-all"
